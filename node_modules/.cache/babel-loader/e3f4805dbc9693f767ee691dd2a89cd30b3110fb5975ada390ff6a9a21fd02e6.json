{"ast":null,"code":"import React,{useRef,useState,useEffect}from\"react\";import{Button,Select,MenuItem,Box,Typography,Grid,Table,TableHead,TableRow,TableCell,TableBody,CircularProgress,TextField,FormControl,InputLabel,Slider,IconButton}from\"@mui/material\";import{ThemeProvider,createTheme}from\"@mui/material/styles\";import{CssBaseline}from\"@mui/material\";import Brightness4Icon from\"@mui/icons-material/Brightness4\";import Brightness7Icon from\"@mui/icons-material/Brightness7\";import Papa from\"papaparse\";import JSZip from\"jszip\";import{saveAs}from\"file-saver\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const behaviors=[\"attacking\",\"jumping\",\"unsupported rearing\",\"supported rearing\",\"grooming\",\"freezing\"];const rowsPerPage=15;function App(){const[intervals,setIntervals]=useState([]);const[intervalStartFrame,setIntervalStartFrame]=useState(\"\");const[intervalEndFrame,setIntervalEndFrame]=useState(\"\");const[intervalBehavior,setIntervalBehavior]=useState(behaviors[0]);const[page,setPage]=useState(0);const[frameRate,setFrameRate]=useState(30);// Default FPS set to 30\nconst[frameInterval,setFrameInterval]=useState(100);// Frame transition interval in ms\nconst[videoUrl,setVideoUrl]=useState(null);const[videoDuration,setVideoDuration]=useState(0);const[currentTime,setCurrentTime]=useState(0);const[currentFrame,setCurrentFrame]=useState(0);const currentFrameRef=useRef(0);const[markStart,setMarkStart]=useState(null);const[isAddingInterval,setIsAddingInterval]=useState(false);const[themeMode,setThemeMode]=useState(\"dark\");const[arrowPressed,setArrowPressed]=useState(null);const[zoom,setZoom]=useState(1);const[panX,setPanX]=useState(0);const[panY,setPanY]=useState(0);const[isDragging,setIsDragging]=useState(false);const[dragStart,setDragStart]=useState({x:0,y:0});const[videoFileName,setVideoFileName]=useState(\"\");const videoRef=useRef(null);const frameIntervalRef=useRef(null);const videoContainerRef=useRef(null);const theme=createTheme({palette:{mode:themeMode,...(themeMode===\"dark\"?{background:{default:\"#2d2d2d\",// Brighter dark gray for main background\npaper:\"#3a3a3a\"// Slightly lighter dark gray for cards/papers\n},text:{primary:\"#e0e0e0\",// Brighter text for better readability\nsecondary:\"#b0b0b0\"// Secondary text color\n},primary:{main:\"#e7657cff\"},divider:\"#4a4a4a\"// Dark gray dividers\n}:{background:{default:\"#ffffff\",paper:\"#ffffff\"},text:{primary:\"#000000\",secondary:\"#666666\"},primary:{main:\"#e7657cff\"},divider:\"#e0e0e0\"})},components:{// Ensure dark theme is applied to borders and other components\n...(themeMode===\"dark\"&&{MuiCssBaseline:{styleOverrides:{body:{backgroundColor:\"#2d2d2d\",margin:0,padding:0},html:{backgroundColor:\"#2d2d2d\"}}},MuiTextField:{styleOverrides:{root:{'& .MuiOutlinedInput-root':{'& fieldset':{borderColor:'#5a5a5a'},'&:hover fieldset':{borderColor:'#7a7a7a'}}}}},MuiButton:{styleOverrides:{outlined:{borderColor:'#5a5a5a','&:hover':{borderColor:'#7a7a7a'}}}}})}});const toggleTheme=()=>{setThemeMode(prev=>prev===\"light\"?\"dark\":\"light\");};// Apply background color to body element immediately\nuseEffect(()=>{const backgroundColor=themeMode===\"dark\"?\"#2d2d2d\":\"#ffffff\";document.body.style.backgroundColor=backgroundColor;document.documentElement.style.backgroundColor=backgroundColor;return()=>{// Clean up on unmount\ndocument.body.style.backgroundColor=\"\";document.documentElement.style.backgroundColor=\"\";};},[themeMode]);function onFileChange(e){const files=Array.from(e.target.files);if(files.length===0){alert(\"Please select a video.\");return;}const file=files[0];if(!file.type.startsWith(\"video/\")){alert(\"Only video files can be selected.\");return;}console.log(\"Video file selected:\",file.name,\"Type:\",file.type);// Store the original file name (without extension) for CSV naming\nconst fileNameWithoutExtension=file.name.replace(/\\.[^/.]+$/,'');setVideoFileName(fileNameWithoutExtension);// Create blob URL directly from the file\nconst videoUrl=URL.createObjectURL(file);setVideoUrl(videoUrl);// Reset all states for new video\nsetCurrentTime(0);setCurrentFrame(0);currentFrameRef.current=0;setIntervals([]);setMarkStart(null);setIntervalStartFrame(\"\");setIntervalEndFrame(\"\");setPage(0);setZoom(1);setPanX(0);setPanY(0);console.log(\"Video loaded successfully:\",file.name);}useEffect(()=>{if(videoUrl&&videoRef.current){console.log(\"Setting video src:\",videoUrl);videoRef.current.src=videoUrl;videoRef.current.load();videoRef.current.onloadedmetadata=()=>{console.log(\"Video metadata loaded, duration:\",videoRef.current.duration);setVideoDuration(videoRef.current.duration);};videoRef.current.onerror=e=>{console.error(\"Video error:\",e);alert(\"Video playback failed: Please check the converted MP4 file.\");};}return()=>{if(videoRef.current){console.log(\"Cleaning up videoRef\");videoRef.current.onloadedmetadata=null;videoRef.current.onerror=null;}};},[videoUrl]);useEffect(()=>{const handleKeyDown=e=>{// Check if user is typing in an input field\nconst activeElement=document.activeElement;const isInInputField=activeElement&&(activeElement.tagName==='INPUT'||activeElement.tagName==='TEXTAREA'||activeElement.contentEditable==='true');// If user is typing in an input field, don't interfere with keyboard input\nif(isInInputField){return;}// Only prevent default for our shortcuts, not for input fields\nif(isAddingInterval)return;if(e.code===\"KeyS\"){e.preventDefault();markIntervalStart();}else if(e.code===\"KeyE\"){e.preventDefault();markIntervalEnd();}else if([\"Digit1\",\"Digit2\",\"Digit3\",\"Digit4\",\"Digit5\",\"Digit6\"].includes(e.code)){e.preventDefault();const behaviorIndex=parseInt(e.code.replace(\"Digit\",\"\"))-1;if(behaviorIndex<behaviors.length&&markStart!==null&&intervalEndFrame!==\"\"){setIsAddingInterval(true);const selectedBehavior=behaviors[behaviorIndex];console.log(`Behavior selected and interval added: ${selectedBehavior}`);setIntervalBehavior(selectedBehavior);addInterval(selectedBehavior);}}else if(e.code===\"ArrowRight\"||e.code===\"ArrowLeft\"){e.preventDefault();setArrowPressed(e.code);}else if(e.code===\"Equal\"||e.code===\"NumpadAdd\"){// + key for zoom in\ne.preventDefault();zoomIn();}else if(e.code===\"Minus\"||e.code===\"NumpadSubtract\"){// - key for zoom out\ne.preventDefault();zoomOut();}else if(e.code===\"Digit0\"||e.code===\"Numpad0\"){// 0 key for reset zoom\ne.preventDefault();resetZoom();}};const handleKeyUp=e=>{if(e.code===\"ArrowRight\"||e.code===\"ArrowLeft\"){setArrowPressed(null);if(markStart!==null){markIntervalEnd();}}};window.addEventListener(\"keydown\",handleKeyDown);window.addEventListener(\"keyup\",handleKeyUp);return()=>{window.removeEventListener(\"keydown\",handleKeyDown);window.removeEventListener(\"keyup\",handleKeyUp);};},[markStart,intervalEndFrame,isAddingInterval]);useEffect(()=>{currentFrameRef.current=currentFrame;},[currentFrame]);useEffect(()=>{if(arrowPressed){const moveFrame=()=>{if(!videoRef.current)return;const direction=arrowPressed===\"ArrowRight\"?1:-1;const newFrame=currentFrameRef.current+direction;const newTime=newFrame/frameRate;if(newTime>=0&&newTime<=videoDuration){setCurrentTime(newTime);setCurrentFrame(newFrame);currentFrameRef.current=newFrame;videoRef.current.currentTime=newTime;console.log(`Moved to frame: ${newFrame}, time: ${newTime.toFixed(2)}s`);}frameIntervalRef.current=setTimeout(moveFrame,frameInterval);};frameIntervalRef.current=setTimeout(moveFrame,frameInterval);}else{if(frameIntervalRef.current){clearTimeout(frameIntervalRef.current);frameIntervalRef.current=null;}}return()=>{if(frameIntervalRef.current){clearTimeout(frameIntervalRef.current);}};},[arrowPressed,frameRate,videoDuration,frameInterval]);useEffect(()=>{if(isAddingInterval){setIsAddingInterval(false);}},[intervals]);// Mouse event handlers for zoom and pan\nuseEffect(()=>{const handleGlobalMouseMove=e=>handleMouseMove(e);const handleGlobalMouseUp=()=>handleMouseUp();if(isDragging){document.addEventListener('mousemove',handleGlobalMouseMove);document.addEventListener('mouseup',handleGlobalMouseUp);}return()=>{document.removeEventListener('mousemove',handleGlobalMouseMove);document.removeEventListener('mouseup',handleGlobalMouseUp);};},[isDragging,dragStart.x,dragStart.y]);function handleTimeUpdate(){if(!videoRef.current)return;const time=videoRef.current.currentTime;setCurrentTime(time);const newFrame=Math.round(time*frameRate);setCurrentFrame(newFrame);currentFrameRef.current=newFrame;}function handleSliderChange(event,newValue){const newTime=newValue/frameRate;setCurrentTime(newTime);setCurrentFrame(newValue);currentFrameRef.current=newValue;if(videoRef.current){console.log(\"Slider changed, setting video frame:\",newValue);videoRef.current.currentTime=newTime;}}function moveNextFrame(){const newFrame=currentFrame+1;const newTime=newFrame/frameRate;if(newTime<=videoDuration){setCurrentTime(newTime);setCurrentFrame(newFrame);currentFrameRef.current=newFrame;if(videoRef.current){videoRef.current.currentTime=newTime;console.log(`Next frame: ${newFrame}, time: ${newTime.toFixed(2)}s`);}}}function movePrevFrame(){const newFrame=currentFrame-1;const newTime=newFrame/frameRate;if(newTime>=0){setCurrentTime(newTime);setCurrentFrame(newFrame);currentFrameRef.current=newFrame;if(videoRef.current){videoRef.current.currentTime=newTime;console.log(`Previous frame: ${newFrame}, time: ${newTime.toFixed(2)}s`);}}}// Zoom functions\nfunction zoomIn(){setZoom(prev=>Math.min(prev*1.5,5));// Max zoom 5x\n}function zoomOut(){setZoom(prev=>Math.max(prev/1.5,0.5));// Min zoom 0.5x\n}function resetZoom(){setZoom(1);setPanX(0);setPanY(0);}function handleWheel(e){e.preventDefault();const delta=e.deltaY>0?0.9:1.1;setZoom(prev=>Math.min(Math.max(prev*delta,0.5),5));}function handleMouseDown(e){setIsDragging(true);setDragStart({x:e.clientX-panX,y:e.clientY-panY});}function handleMouseMove(e){if(!isDragging)return;setPanX(e.clientX-dragStart.x);setPanY(e.clientY-dragStart.y);}function handleMouseUp(){setIsDragging(false);}function markIntervalStart(){setMarkStart(currentFrameRef.current);setIntervalStartFrame(currentFrameRef.current);setIntervalEndFrame(\"\");console.log(\"Interval start marked:\",currentFrameRef.current);}function markIntervalEnd(){if(markStart===null){alert(\"Please mark the start frame first.\");return;}setIntervalEndFrame(currentFrameRef.current);console.log(\"Interval end updated:\",currentFrameRef.current);}function addInterval(behavior){const startFrame=parseInt(intervalStartFrame);const endFrame=parseInt(intervalEndFrame);const startTime=startFrame/frameRate;const endTime=endFrame/frameRate;const maxFrame=Math.round(videoDuration*frameRate);if(isNaN(startFrame)||isNaN(endFrame)){alert(\"Start and end frames must be valid numbers.\");setIsAddingInterval(false);return;}if(startFrame<0||endFrame>maxFrame){alert(`Frames must be between 0 and ${maxFrame}.`);setIsAddingInterval(false);return;}if(startFrame>=endFrame){alert(\"Start frame must be less than end frame.\");setIsAddingInterval(false);return;}setIntervals(prev=>[...prev,{start:startFrame,end:endFrame,startTime,endTime,behavior,auto:false}]);setIntervalStartFrame(\"\");setIntervalEndFrame(\"\");setIntervalBehavior(behaviors[0]);setMarkStart(null);setPage(0);console.log(\"Interval added:\",{start:startFrame,end:endFrame,startTime,endTime,behavior});}function updateIntervalBehavior(idx,newBehavior){setIntervals(prev=>prev.map((interval,i)=>i===idx?{...interval,behavior:newBehavior}:interval));console.log(\"Interval behavior updated:\",{idx,behavior:newBehavior});}function removeInterval(idx){setIntervals(intervals.filter((_,i)=>i!==idx));if(page*rowsPerPage>=intervals.length-1){setPage(Math.max(0,page-1));}}function downloadCsvAll(){const zip=new JSZip();const intervalData=intervals.map(i=>({type:\"interval\",start_time:i.startTime.toFixed(2),end_time:i.endTime.toFixed(2),start_frame:i.start,end_frame:i.end,behavior:i.behavior}));const intervalCsv=Papa.unparse(intervalData);// Use video file name for CSV and ZIP naming\nconst baseFileName=videoFileName||\"behavior_labels\";const csvFileName=`${baseFileName}_intervals.csv`;const zipFileName=`${baseFileName}_behavior_labels.zip`;zip.file(csvFileName,intervalCsv);zip.generateAsync({type:\"blob\"}).then(blob=>{saveAs(blob,zipFileName);});}return/*#__PURE__*/_jsxs(ThemeProvider,{theme:theme,children:[/*#__PURE__*/_jsx(CssBaseline,{}),/*#__PURE__*/_jsxs(Box,{sx:{minHeight:'100vh',bgcolor:'background.default',color:'text.primary',p:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Behavior Labeling Tool\"}),/*#__PURE__*/_jsx(IconButton,{onClick:toggleTheme,color:\"inherit\",\"aria-label\":\"Toggle theme\",children:themeMode===\"light\"?/*#__PURE__*/_jsx(Brightness4Icon,{}):/*#__PURE__*/_jsx(Brightness7Icon,{})})]}),/*#__PURE__*/_jsxs(Box,{sx:{my:2,display:'flex',gap:2,alignItems:'center'},children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",gutterBottom:true,children:\"Select Video\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"video/*\",onChange:onFileChange,\"aria-label\":\"Select video file\"})]}),/*#__PURE__*/_jsx(TextField,{label:\"Frame Rate (FPS)\",type:\"number\",value:frameRate,onChange:e=>{setFrameRate(e.target.value);},onBlur:()=>{const numValue=parseFloat(frameRate);if(isNaN(numValue)||numValue<1){setFrameRate(30);}else{setFrameRate(numValue);}},size:\"small\",inputProps:{min:1,step:1},\"aria-label\":\"Frame rate\",sx:{width:'150px'}}),/*#__PURE__*/_jsx(TextField,{label:\"Frame Interval (ms)\",type:\"number\",value:frameInterval,onChange:e=>{setFrameInterval(e.target.value);},onBlur:()=>{const numValue=parseInt(frameInterval);if(isNaN(numValue)||numValue<10){setFrameInterval(100);}else{setFrameInterval(numValue);}},size:\"small\",inputProps:{min:10,step:10},\"aria-label\":\"Frame transition interval\",sx:{width:'150px'}}),/*#__PURE__*/_jsx(Button,{onClick:downloadCsvAll,variant:\"contained\",color:\"primary\",\"aria-label\":\"Save CSV\",children:\"Save CSV\"})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Video\"}),!videoUrl?/*#__PURE__*/_jsx(Box,{sx:{width:\"100%\",maxWidth:\"800px\",height:\"450px\",bgcolor:'background.paper',border:1,borderColor:'divider',display:\"flex\",alignItems:\"center\",justifyContent:\"center\",color:'text.secondary',fontSize:\"1.2rem\",borderRadius:\"4px\"},\"aria-label\":\"Video placeholder\",children:\"Please upload a video\"}):/*#__PURE__*/_jsx(Box,{ref:videoContainerRef,sx:{width:\"100%\",maxWidth:\"800px\",height:\"450px\",border:1,borderColor:'divider',borderRadius:\"4px\",overflow:\"hidden\",position:\"relative\",cursor:isDragging?'grabbing':zoom>1?'grab':'default',backgroundColor:'#000'},onWheel:handleWheel,onMouseDown:handleMouseDown,children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,style:{width:\"100%\",height:\"100%\",objectFit:\"contain\",transform:`scale(${zoom}) translate(${panX/zoom}px, ${panY/zoom}px)`,transformOrigin:\"center center\",transition:isDragging?'none':'transform 0.1s ease-out'},onTimeUpdate:handleTimeUpdate})}),videoUrl&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,mt:1,alignItems:'center'},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:movePrevFrame,\"aria-label\":\"Previous frame\",children:\"Prev Frame\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:moveNextFrame,\"aria-label\":\"Next frame\",children:\"Next Frame\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:markIntervalStart,\"aria-label\":\"Mark start frame\",children:\"Mark Start (S)\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:markIntervalEnd,\"aria-label\":\"Mark end frame\",children:\"Mark End (E)\"}),/*#__PURE__*/_jsxs(Typography,{children:[\"Current Frame: \",currentFrame,\" / \",Math.round(videoDuration*frameRate)]})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,mt:1,alignItems:'center'},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:zoomIn,\"aria-label\":\"Zoom in\",children:\"Zoom In (+)\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:zoomOut,\"aria-label\":\"Zoom out\",children:\"Zoom Out (-)\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:resetZoom,\"aria-label\":\"Reset zoom\",children:\"Reset Zoom\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[\"Zoom: \",Math.round(zoom*100),\"%\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{ml:2},children:\"Mouse wheel to zoom, click and drag to pan\"})]}),/*#__PURE__*/_jsx(Slider,{value:currentFrame,min:0,max:Math.round(videoDuration*frameRate),step:1,onChange:handleSliderChange,\"aria-label\":\"Video frame timeline\",sx:{mt:2}})]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsxs(Box,{sx:{p:2,border:1,borderColor:'divider',borderRadius:1,bgcolor:'background.paper',height:'100%'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Behavior Intervals\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",gutterBottom:true,children:\"Shortcuts: ArrowRight/ArrowLeft to navigate and mark end, S to mark start, E to update end, 1-6 to select behavior and add interval, +/- to zoom, 0 to reset zoom\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(TextField,{label:\"Start Frame\",type:\"number\",value:intervalStartFrame,onChange:e=>{const v=e.target.value;console.log(\"Start Frame input:\",v);setIntervalStartFrame(v);if(v!==\"\")setMarkStart(Number(v));else setMarkStart(null);},size:\"small\",inputProps:{min:0,step:1},\"aria-label\":\"Interval start frame\"}),/*#__PURE__*/_jsx(TextField,{label:\"End Frame\",type:\"number\",value:intervalStartFrame!==\"\"?intervalEndFrame:\"\",onChange:e=>{const v=e.target.value;console.log(\"End Frame input:\",v);setIntervalEndFrame(v);},size:\"small\",inputProps:{min:intervalStartFrame!==\"\"?Number(intervalStartFrame):0,step:1},\"aria-label\":\"Interval end frame\",disabled:intervalStartFrame===\"\"}),/*#__PURE__*/_jsxs(FormControl,{size:\"small\",sx:{minWidth:200},children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Behavior\"}),/*#__PURE__*/_jsx(Select,{value:intervalBehavior,label:\"Behavior\",onChange:e=>setIntervalBehavior(e.target.value),children:behaviors.map((b,i)=>/*#__PURE__*/_jsx(MenuItem,{value:b,children:`${b} (${i+1})`},b))})]}),/*#__PURE__*/_jsx(Button,{onClick:()=>addInterval(intervalBehavior),variant:\"contained\",\"aria-label\":\"Add interval\",disabled:intervalStartFrame===\"\"||intervalEndFrame===\"\",children:\"Add\"})]}),/*#__PURE__*/_jsxs(Table,{size:\"small\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Interval (Frame)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Behavior\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Delete\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:intervals.length===0?/*#__PURE__*/_jsx(TableRow,{children:/*#__PURE__*/_jsx(TableCell,{colSpan:3,align:\"center\",children:\"No intervals added yet.\"})}):intervals.slice().sort((a,b)=>b.start-a.start).slice(page*rowsPerPage,(page+1)*rowsPerPage).map((interval,i)=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:`${interval.start} - ${interval.end}`}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(FormControl,{size:\"small\",sx:{minWidth:200},children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Behavior\"}),/*#__PURE__*/_jsx(Select,{value:interval.behavior,label:\"Behavior\",onChange:e=>updateIntervalBehavior(intervals.indexOf(interval),e.target.value),children:behaviors.map((b,j)=>/*#__PURE__*/_jsx(MenuItem,{value:b,children:`${b} (${j+1})`},b))})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"error\",size:\"small\",onClick:()=>removeInterval(intervals.indexOf(interval)),\"aria-label\":`Delete interval ${i+1}`,children:\"Delete\"})})]},i))})]}),intervals.length>rowsPerPage&&/*#__PURE__*/_jsxs(Box,{sx:{mt:2,display:'flex',gap:2},children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setPage(p=>Math.max(0,p-1)),disabled:page===0,variant:\"outlined\",\"aria-label\":\"Previous page\",children:\"Previous\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>setPage(p=>p+1),disabled:(page+1)*rowsPerPage>=intervals.length,variant:\"outlined\",\"aria-label\":\"Next page\",children:\"Next\"}),/*#__PURE__*/_jsxs(Typography,{children:[\"Page \",page+1,\" / \",Math.ceil(intervals.length/rowsPerPage)]})]})]})})]})]})]});}export default App;","map":{"version":3,"names":["React","useRef","useState","useEffect","Button","Select","MenuItem","Box","Typography","Grid","Table","TableHead","TableRow","TableCell","TableBody","CircularProgress","TextField","FormControl","InputLabel","Slider","IconButton","ThemeProvider","createTheme","CssBaseline","Brightness4Icon","Brightness7Icon","Papa","JSZip","saveAs","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","behaviors","rowsPerPage","App","intervals","setIntervals","intervalStartFrame","setIntervalStartFrame","intervalEndFrame","setIntervalEndFrame","intervalBehavior","setIntervalBehavior","page","setPage","frameRate","setFrameRate","frameInterval","setFrameInterval","videoUrl","setVideoUrl","videoDuration","setVideoDuration","currentTime","setCurrentTime","currentFrame","setCurrentFrame","currentFrameRef","markStart","setMarkStart","isAddingInterval","setIsAddingInterval","themeMode","setThemeMode","arrowPressed","setArrowPressed","zoom","setZoom","panX","setPanX","panY","setPanY","isDragging","setIsDragging","dragStart","setDragStart","x","y","videoFileName","setVideoFileName","videoRef","frameIntervalRef","videoContainerRef","theme","palette","mode","background","default","paper","text","primary","secondary","main","divider","components","MuiCssBaseline","styleOverrides","body","backgroundColor","margin","padding","html","MuiTextField","root","borderColor","MuiButton","outlined","toggleTheme","prev","document","style","documentElement","onFileChange","e","files","Array","from","target","length","alert","file","type","startsWith","console","log","name","fileNameWithoutExtension","replace","URL","createObjectURL","current","src","load","onloadedmetadata","duration","onerror","error","handleKeyDown","activeElement","isInInputField","tagName","contentEditable","code","preventDefault","markIntervalStart","markIntervalEnd","includes","behaviorIndex","parseInt","selectedBehavior","addInterval","zoomIn","zoomOut","resetZoom","handleKeyUp","window","addEventListener","removeEventListener","moveFrame","direction","newFrame","newTime","toFixed","setTimeout","clearTimeout","handleGlobalMouseMove","handleMouseMove","handleGlobalMouseUp","handleMouseUp","handleTimeUpdate","time","Math","round","handleSliderChange","event","newValue","moveNextFrame","movePrevFrame","min","max","handleWheel","delta","deltaY","handleMouseDown","clientX","clientY","behavior","startFrame","endFrame","startTime","endTime","maxFrame","isNaN","start","end","auto","updateIntervalBehavior","idx","newBehavior","map","interval","i","removeInterval","filter","_","downloadCsvAll","zip","intervalData","start_time","end_time","start_frame","end_frame","intervalCsv","unparse","baseFileName","csvFileName","zipFileName","generateAsync","then","blob","children","sx","minHeight","bgcolor","color","p","display","justifyContent","alignItems","mb","variant","gutterBottom","onClick","my","gap","accept","onChange","label","value","onBlur","numValue","parseFloat","size","inputProps","step","width","container","spacing","item","xs","maxWidth","height","border","fontSize","borderRadius","ref","overflow","position","cursor","onWheel","onMouseDown","objectFit","transform","transformOrigin","transition","onTimeUpdate","mt","ml","v","Number","disabled","minWidth","b","colSpan","align","slice","sort","a","indexOf","j","ceil"],"sources":["/media/sj/linux/annotator/behavior_annotator/ba_v2/frontend/src/App.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\nimport {\n  Button, Select, MenuItem, Box, Typography, Grid,\n  Table, TableHead, TableRow, TableCell, TableBody, CircularProgress,\n  TextField, FormControl, InputLabel, Slider, IconButton\n} from \"@mui/material\";\nimport { ThemeProvider, createTheme } from \"@mui/material/styles\";\nimport { CssBaseline } from \"@mui/material\";\nimport Brightness4Icon from \"@mui/icons-material/Brightness4\";\nimport Brightness7Icon from \"@mui/icons-material/Brightness7\";\nimport Papa from \"papaparse\";\nimport JSZip from \"jszip\";\nimport { saveAs } from \"file-saver\";\n\nconst behaviors = [\"attacking\", \"jumping\", \"unsupported rearing\", \"supported rearing\", \"grooming\", \"freezing\"];\nconst rowsPerPage = 15;\n\nfunction App() {\n  const [intervals, setIntervals] = useState([]);\n  const [intervalStartFrame, setIntervalStartFrame] = useState(\"\");\n  const [intervalEndFrame, setIntervalEndFrame] = useState(\"\");\n  const [intervalBehavior, setIntervalBehavior] = useState(behaviors[0]);\n\n  const [page, setPage] = useState(0);\n  const [frameRate, setFrameRate] = useState(30); // Default FPS set to 30\n  const [frameInterval, setFrameInterval] = useState(100); // Frame transition interval in ms\n  const [videoUrl, setVideoUrl] = useState(null);\n  const [videoDuration, setVideoDuration] = useState(0);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [currentFrame, setCurrentFrame] = useState(0);\n  const currentFrameRef = useRef(0);\n  const [markStart, setMarkStart] = useState(null);\n  const [isAddingInterval, setIsAddingInterval] = useState(false);\n  const [themeMode, setThemeMode] = useState(\"dark\");\n  const [arrowPressed, setArrowPressed] = useState(null);\n  const [zoom, setZoom] = useState(1);\n  const [panX, setPanX] = useState(0);\n  const [panY, setPanY] = useState(0);\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [videoFileName, setVideoFileName] = useState(\"\");\n\n  const videoRef = useRef(null);\n  const frameIntervalRef = useRef(null);\n  const videoContainerRef = useRef(null);\n\n  const theme = createTheme({\n    palette: {\n      mode: themeMode,\n      ...(themeMode === \"dark\" ? {\n        background: { \n          default: \"#2d2d2d\", // Brighter dark gray for main background\n          paper: \"#3a3a3a\"    // Slightly lighter dark gray for cards/papers\n        },\n        text: { \n          primary: \"#e0e0e0\",   // Brighter text for better readability\n          secondary: \"#b0b0b0\"  // Secondary text color\n        },\n        primary: { main: \"#e7657cff\" },\n        divider: \"#4a4a4a\",     // Dark gray dividers\n      } : {\n        background: { default: \"#ffffff\", paper: \"#ffffff\" },\n        text: { primary: \"#000000\", secondary: \"#666666\" },\n        primary: { main: \"#e7657cff\" },\n        divider: \"#e0e0e0\",\n      }),\n    },\n    components: {\n      // Ensure dark theme is applied to borders and other components\n      ...(themeMode === \"dark\" && {\n        MuiCssBaseline: {\n          styleOverrides: {\n            body: {\n              backgroundColor: \"#2d2d2d\",\n              margin: 0,\n              padding: 0,\n            },\n            html: {\n              backgroundColor: \"#2d2d2d\",\n            }\n          },\n        },\n        MuiTextField: {\n          styleOverrides: {\n            root: {\n              '& .MuiOutlinedInput-root': {\n                '& fieldset': {\n                  borderColor: '#5a5a5a',\n                },\n                '&:hover fieldset': {\n                  borderColor: '#7a7a7a',\n                },\n              },\n            },\n          },\n        },\n        MuiButton: {\n          styleOverrides: {\n            outlined: {\n              borderColor: '#5a5a5a',\n              '&:hover': {\n                borderColor: '#7a7a7a',\n              },\n            },\n          },\n        },\n      }),\n    },\n  });\n\n  const toggleTheme = () => {\n    setThemeMode(prev => (prev === \"light\" ? \"dark\" : \"light\"));\n  };\n\n  // Apply background color to body element immediately\n  useEffect(() => {\n    const backgroundColor = themeMode === \"dark\" ? \"#2d2d2d\" : \"#ffffff\";\n    document.body.style.backgroundColor = backgroundColor;\n    document.documentElement.style.backgroundColor = backgroundColor;\n    \n    return () => {\n      // Clean up on unmount\n      document.body.style.backgroundColor = \"\";\n      document.documentElement.style.backgroundColor = \"\";\n    };\n  }, [themeMode]);\n\n  function onFileChange(e) {\n    const files = Array.from(e.target.files);\n    if (files.length === 0) {\n      alert(\"Please select a video.\");\n      return;\n    }\n\n    const file = files[0];\n    if (!file.type.startsWith(\"video/\")) {\n      alert(\"Only video files can be selected.\");\n      return;\n    }\n    console.log(\"Video file selected:\", file.name, \"Type:\", file.type);\n    \n    // Store the original file name (without extension) for CSV naming\n    const fileNameWithoutExtension = file.name.replace(/\\.[^/.]+$/, '');\n    setVideoFileName(fileNameWithoutExtension);\n\n    // Create blob URL directly from the file\n    const videoUrl = URL.createObjectURL(file);\n    setVideoUrl(videoUrl);\n    \n    // Reset all states for new video\n    setCurrentTime(0);\n    setCurrentFrame(0);\n    currentFrameRef.current = 0;\n    setIntervals([]);\n    setMarkStart(null);\n    setIntervalStartFrame(\"\");\n    setIntervalEndFrame(\"\");\n    setPage(0);\n    setZoom(1);\n    setPanX(0);\n    setPanY(0);\n    \n    console.log(\"Video loaded successfully:\", file.name);\n  }\n\n  useEffect(() => {\n    if (videoUrl && videoRef.current) {\n      console.log(\"Setting video src:\", videoUrl);\n      videoRef.current.src = videoUrl;\n      videoRef.current.load();\n      videoRef.current.onloadedmetadata = () => {\n        console.log(\"Video metadata loaded, duration:\", videoRef.current.duration);\n        setVideoDuration(videoRef.current.duration);\n      };\n      videoRef.current.onerror = (e) => {\n        console.error(\"Video error:\", e);\n        alert(\"Video playback failed: Please check the converted MP4 file.\");\n      };\n    }\n    return () => {\n      if (videoRef.current) {\n        console.log(\"Cleaning up videoRef\");\n        videoRef.current.onloadedmetadata = null;\n        videoRef.current.onerror = null;\n      }\n    };\n  }, [videoUrl]);\n\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      // Check if user is typing in an input field\n      const activeElement = document.activeElement;\n      const isInInputField = activeElement && (\n        activeElement.tagName === 'INPUT' || \n        activeElement.tagName === 'TEXTAREA' ||\n        activeElement.contentEditable === 'true'\n      );\n      \n      // If user is typing in an input field, don't interfere with keyboard input\n      if (isInInputField) {\n        return;\n      }\n      \n      // Only prevent default for our shortcuts, not for input fields\n      if (isAddingInterval) return;\n      \n      if (e.code === \"KeyS\") {\n        e.preventDefault();\n        markIntervalStart();\n      } else if (e.code === \"KeyE\") {\n        e.preventDefault();\n        markIntervalEnd();\n      } else if ([\"Digit1\", \"Digit2\", \"Digit3\", \"Digit4\", \"Digit5\", \"Digit6\"].includes(e.code)) {\n        e.preventDefault();\n        const behaviorIndex = parseInt(e.code.replace(\"Digit\", \"\")) - 1;\n        if (behaviorIndex < behaviors.length && markStart !== null && intervalEndFrame !== \"\") {\n          setIsAddingInterval(true);\n          const selectedBehavior = behaviors[behaviorIndex];\n          console.log(`Behavior selected and interval added: ${selectedBehavior}`);\n          setIntervalBehavior(selectedBehavior);\n          addInterval(selectedBehavior);\n        }\n      } else if (e.code === \"ArrowRight\" || e.code === \"ArrowLeft\") {\n        e.preventDefault();\n        setArrowPressed(e.code);\n      } else if (e.code === \"Equal\" || e.code === \"NumpadAdd\") { // + key for zoom in\n        e.preventDefault();\n        zoomIn();\n      } else if (e.code === \"Minus\" || e.code === \"NumpadSubtract\") { // - key for zoom out\n        e.preventDefault();\n        zoomOut();\n      } else if (e.code === \"Digit0\" || e.code === \"Numpad0\") { // 0 key for reset zoom\n        e.preventDefault();\n        resetZoom();\n      }\n    };\n\n    const handleKeyUp = (e) => {\n      if (e.code === \"ArrowRight\" || e.code === \"ArrowLeft\") {\n        setArrowPressed(null);\n        if (markStart !== null) {\n          markIntervalEnd();\n        }\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    window.addEventListener(\"keyup\", handleKeyUp);\n    return () => {\n      window.removeEventListener(\"keydown\", handleKeyDown);\n      window.removeEventListener(\"keyup\", handleKeyUp);\n    };\n  }, [markStart, intervalEndFrame, isAddingInterval]);\n\n  useEffect(() => {\n    currentFrameRef.current = currentFrame;\n  }, [currentFrame]);\n\n  useEffect(() => {\n    if (arrowPressed) {\n      const moveFrame = () => {\n        if (!videoRef.current) return;\n        const direction = arrowPressed === \"ArrowRight\" ? 1 : -1;\n        const newFrame = currentFrameRef.current + direction;\n        const newTime = newFrame / frameRate;\n        if (newTime >= 0 && newTime <= videoDuration) {\n          setCurrentTime(newTime);\n          setCurrentFrame(newFrame);\n          currentFrameRef.current = newFrame;\n          videoRef.current.currentTime = newTime;\n          console.log(`Moved to frame: ${newFrame}, time: ${newTime.toFixed(2)}s`);\n        }\n        frameIntervalRef.current = setTimeout(moveFrame, frameInterval);\n      };\n      frameIntervalRef.current = setTimeout(moveFrame, frameInterval);\n    } else {\n      if (frameIntervalRef.current) {\n        clearTimeout(frameIntervalRef.current);\n        frameIntervalRef.current = null;\n      }\n    }\n    return () => {\n      if (frameIntervalRef.current) {\n        clearTimeout(frameIntervalRef.current);\n      }\n    };\n  }, [arrowPressed, frameRate, videoDuration, frameInterval]);\n\n  useEffect(() => {\n    if (isAddingInterval) {\n      setIsAddingInterval(false);\n    }\n  }, [intervals]);\n\n  // Mouse event handlers for zoom and pan\n  useEffect(() => {\n    const handleGlobalMouseMove = (e) => handleMouseMove(e);\n    const handleGlobalMouseUp = () => handleMouseUp();\n\n    if (isDragging) {\n      document.addEventListener('mousemove', handleGlobalMouseMove);\n      document.addEventListener('mouseup', handleGlobalMouseUp);\n    }\n\n    return () => {\n      document.removeEventListener('mousemove', handleGlobalMouseMove);\n      document.removeEventListener('mouseup', handleGlobalMouseUp);\n    };\n  }, [isDragging, dragStart.x, dragStart.y]);\n\n  function handleTimeUpdate() {\n    if (!videoRef.current) return;\n    const time = videoRef.current.currentTime;\n    setCurrentTime(time);\n    const newFrame = Math.round(time * frameRate);\n    setCurrentFrame(newFrame);\n    currentFrameRef.current = newFrame;\n  }\n\n  function handleSliderChange(event, newValue) {\n    const newTime = newValue / frameRate;\n    setCurrentTime(newTime);\n    setCurrentFrame(newValue);\n    currentFrameRef.current = newValue;\n    if (videoRef.current) {\n      console.log(\"Slider changed, setting video frame:\", newValue);\n      videoRef.current.currentTime = newTime;\n    }\n  }\n\n  function moveNextFrame() {\n    const newFrame = currentFrame + 1;\n    const newTime = newFrame / frameRate;\n    if (newTime <= videoDuration) {\n      setCurrentTime(newTime);\n      setCurrentFrame(newFrame);\n      currentFrameRef.current = newFrame;\n      if (videoRef.current) {\n        videoRef.current.currentTime = newTime;\n        console.log(`Next frame: ${newFrame}, time: ${newTime.toFixed(2)}s`);\n      }\n    }\n  }\n\n  function movePrevFrame() {\n    const newFrame = currentFrame - 1;\n    const newTime = newFrame / frameRate;\n    if (newTime >= 0) {\n      setCurrentTime(newTime);\n      setCurrentFrame(newFrame);\n      currentFrameRef.current = newFrame;\n      if (videoRef.current) {\n        videoRef.current.currentTime = newTime;\n        console.log(`Previous frame: ${newFrame}, time: ${newTime.toFixed(2)}s`);\n      }\n    }\n  }\n\n  // Zoom functions\n  function zoomIn() {\n    setZoom(prev => Math.min(prev * 1.5, 5)); // Max zoom 5x\n  }\n\n  function zoomOut() {\n    setZoom(prev => Math.max(prev / 1.5, 0.5)); // Min zoom 0.5x\n  }\n\n  function resetZoom() {\n    setZoom(1);\n    setPanX(0);\n    setPanY(0);\n  }\n\n  function handleWheel(e) {\n    e.preventDefault();\n    const delta = e.deltaY > 0 ? 0.9 : 1.1;\n    setZoom(prev => Math.min(Math.max(prev * delta, 0.5), 5));\n  }\n\n  function handleMouseDown(e) {\n    setIsDragging(true);\n    setDragStart({ x: e.clientX - panX, y: e.clientY - panY });\n  }\n\n  function handleMouseMove(e) {\n    if (!isDragging) return;\n    setPanX(e.clientX - dragStart.x);\n    setPanY(e.clientY - dragStart.y);\n  }\n\n  function handleMouseUp() {\n    setIsDragging(false);\n  }\n\n  function markIntervalStart() {\n    setMarkStart(currentFrameRef.current);\n    setIntervalStartFrame(currentFrameRef.current);\n    setIntervalEndFrame(\"\");\n    console.log(\"Interval start marked:\", currentFrameRef.current);\n  }\n\n  function markIntervalEnd() {\n    if (markStart === null) {\n      alert(\"Please mark the start frame first.\");\n      return;\n    }\n    setIntervalEndFrame(currentFrameRef.current);\n    console.log(\"Interval end updated:\", currentFrameRef.current);\n  }\n\n  function addInterval(behavior) {\n    const startFrame = parseInt(intervalStartFrame);\n    const endFrame = parseInt(intervalEndFrame);\n    const startTime = startFrame / frameRate;\n    const endTime = endFrame / frameRate;\n    const maxFrame = Math.round(videoDuration * frameRate);\n    if (isNaN(startFrame) || isNaN(endFrame)) {\n      alert(\"Start and end frames must be valid numbers.\");\n      setIsAddingInterval(false);\n      return;\n    }\n    if (startFrame < 0 || endFrame > maxFrame) {\n      alert(`Frames must be between 0 and ${maxFrame}.`);\n      setIsAddingInterval(false);\n      return;\n    }\n    if (startFrame >= endFrame) {\n      alert(\"Start frame must be less than end frame.\");\n      setIsAddingInterval(false);\n      return;\n    }\n    setIntervals(prev => [\n      ...prev,\n      { start: startFrame, end: endFrame, startTime, endTime, behavior, auto: false },\n    ]);\n    setIntervalStartFrame(\"\");\n    setIntervalEndFrame(\"\");\n    setIntervalBehavior(behaviors[0]);\n    setMarkStart(null);\n    setPage(0);\n    console.log(\"Interval added:\", { start: startFrame, end: endFrame, startTime, endTime, behavior });\n  }\n\n  function updateIntervalBehavior(idx, newBehavior) {\n    setIntervals(prev =>\n      prev.map((interval, i) =>\n        i === idx ? { ...interval, behavior: newBehavior } : interval\n      )\n    );\n    console.log(\"Interval behavior updated:\", { idx, behavior: newBehavior });\n  }\n\n  function removeInterval(idx) {\n    setIntervals(intervals.filter((_, i) => i !== idx));\n    if (page * rowsPerPage >= intervals.length - 1) {\n      setPage(Math.max(0, page - 1));\n    }\n  }\n\n  function downloadCsvAll() {\n    const zip = new JSZip();\n    const intervalData = intervals.map(i => ({\n      type: \"interval\",\n      start_time: i.startTime.toFixed(2),\n      end_time: i.endTime.toFixed(2),\n      start_frame: i.start,\n      end_frame: i.end,\n      behavior: i.behavior,\n    }));\n    const intervalCsv = Papa.unparse(intervalData);\n    \n    // Use video file name for CSV and ZIP naming\n    const baseFileName = videoFileName || \"behavior_labels\";\n    const csvFileName = `${baseFileName}_intervals.csv`;\n    const zipFileName = `${baseFileName}_behavior_labels.zip`;\n    \n    zip.file(csvFileName, intervalCsv);\n    zip.generateAsync({ type: \"blob\" }).then(blob => {\n      saveAs(blob, zipFileName);\n    });\n  }\n\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline />\n      <Box sx={{ \n        minHeight: '100vh', \n        bgcolor: 'background.default', \n        color: 'text.primary',\n        p: 2\n      }}>\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n          <Typography variant=\"h4\" gutterBottom>Behavior Labeling Tool</Typography>\n          <IconButton onClick={toggleTheme} color=\"inherit\" aria-label=\"Toggle theme\">\n            {themeMode === \"light\" ? <Brightness4Icon /> : <Brightness7Icon />}\n          </IconButton>\n        </Box>\n        <Box sx={{ my: 2, display: 'flex', gap: 2, alignItems: 'center' }}>\n          <Box>\n            <Typography variant=\"body2\" gutterBottom>Select Video</Typography>\n            <input\n              type=\"file\"\n              accept=\"video/*\"\n              onChange={onFileChange}\n              aria-label=\"Select video file\"\n            />\n          </Box>\n          <TextField\n            label=\"Frame Rate (FPS)\"\n            type=\"number\"\n            value={frameRate}\n            onChange={(e) => {\n              setFrameRate(e.target.value);\n            }}\n            onBlur={() => {\n              const numValue = parseFloat(frameRate);\n              if (isNaN(numValue) || numValue < 1) {\n                setFrameRate(30);\n              } else {\n                setFrameRate(numValue);\n              }\n            }}\n            size=\"small\"\n            inputProps={{ min: 1, step: 1 }}\n            aria-label=\"Frame rate\"\n            sx={{ width: '150px' }}\n          />\n          <TextField\n            label=\"Frame Interval (ms)\"\n            type=\"number\"\n            value={frameInterval}\n            onChange={(e) => {\n              setFrameInterval(e.target.value);\n            }}\n            onBlur={() => {\n              const numValue = parseInt(frameInterval);\n              if (isNaN(numValue) || numValue < 10) {\n                setFrameInterval(100);\n              } else {\n                setFrameInterval(numValue);\n              }\n            }}\n            size=\"small\"\n            inputProps={{ min: 10, step: 10 }}\n            aria-label=\"Frame transition interval\"\n            sx={{ width: '150px' }}\n          />\n          <Button\n            onClick={downloadCsvAll}\n            variant=\"contained\"\n            color=\"primary\"\n            aria-label=\"Save CSV\"\n          >\n            Save CSV\n          </Button>\n        </Box>\n\n        <Grid container spacing={2}>\n          <Grid item xs={6}>\n            <Typography variant=\"h6\">Video</Typography>\n            {!videoUrl ? (\n              <Box\n                sx={{\n                  width: \"100%\",\n                  maxWidth: \"800px\",\n                  height: \"450px\",\n                  bgcolor: 'background.paper',\n                  border: 1,\n                  borderColor: 'divider',\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  color: 'text.secondary',\n                  fontSize: \"1.2rem\",\n                  borderRadius: \"4px\",\n                }}\n                aria-label=\"Video placeholder\"\n              >\n                Please upload a video\n              </Box>\n            ) : (\n                              <Box\n                  ref={videoContainerRef}\n                  sx={{\n                    width: \"100%\",\n                    maxWidth: \"800px\",\n                    height: \"450px\",\n                    border: 1,\n                    borderColor: 'divider',\n                    borderRadius: \"4px\",\n                    overflow: \"hidden\",\n                    position: \"relative\",\n                    cursor: isDragging ? 'grabbing' : (zoom > 1 ? 'grab' : 'default'),\n                    backgroundColor: '#000'\n                  }}\n                  onWheel={handleWheel}\n                  onMouseDown={handleMouseDown}\n                >\n                <video\n                  ref={videoRef}\n                  style={{\n                    width: \"100%\",\n                    height: \"100%\",\n                    objectFit: \"contain\",\n                    transform: `scale(${zoom}) translate(${panX / zoom}px, ${panY / zoom}px)`,\n                    transformOrigin: \"center center\",\n                    transition: isDragging ? 'none' : 'transform 0.1s ease-out'\n                  }}\n                  onTimeUpdate={handleTimeUpdate}\n                />\n              </Box>\n            )}\n            {videoUrl && (\n              <>\n                <Box sx={{ display: 'flex', gap: 2, mt: 1, alignItems: 'center' }}>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={movePrevFrame}\n                    aria-label=\"Previous frame\"\n                  >\n                    Prev Frame\n                  </Button>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={moveNextFrame}\n                    aria-label=\"Next frame\"\n                  >\n                    Next Frame\n                  </Button>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={markIntervalStart}\n                    aria-label=\"Mark start frame\"\n                  >\n                    Mark Start (S)\n                  </Button>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={markIntervalEnd}\n                    aria-label=\"Mark end frame\"\n                  >\n                    Mark End (E)\n                  </Button>\n                  <Typography>\n                    Current Frame: {currentFrame} / {Math.round(videoDuration * frameRate)}\n                  </Typography>\n                </Box>\n                <Box sx={{ display: 'flex', gap: 2, mt: 1, alignItems: 'center' }}>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={zoomIn}\n                    aria-label=\"Zoom in\"\n                  >\n                    Zoom In (+)\n                  </Button>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={zoomOut}\n                    aria-label=\"Zoom out\"\n                  >\n                    Zoom Out (-)\n                  </Button>\n                  <Button\n                    variant=\"outlined\"\n                    onClick={resetZoom}\n                    aria-label=\"Reset zoom\"\n                  >\n                    Reset Zoom\n                  </Button>\n                  <Typography variant=\"body2\">\n                    Zoom: {Math.round(zoom * 100)}%\n                  </Typography>\n                  <Typography variant=\"caption\" sx={{ ml: 2 }}>\n                    Mouse wheel to zoom, click and drag to pan\n                  </Typography>\n                </Box>\n                <Slider\n                  value={currentFrame}\n                  min={0}\n                  max={Math.round(videoDuration * frameRate)}\n                  step={1}\n                  onChange={handleSliderChange}\n                  aria-label=\"Video frame timeline\"\n                  sx={{ mt: 2 }}\n                />\n              </>\n            )}\n          </Grid>\n          <Grid item xs={6}>\n            <Box sx={{ \n              p: 2, \n              border: 1, \n              borderColor: 'divider', \n              borderRadius: 1, \n              bgcolor: 'background.paper', \n              height: '100%' \n            }}>\n              <Typography variant=\"h6\" gutterBottom>Behavior Intervals</Typography>\n              <Typography variant=\"body2\" gutterBottom>\n                Shortcuts: ArrowRight/ArrowLeft to navigate and mark end, S to mark start, E to update end, 1-6 to select behavior and add interval, +/- to zoom, 0 to reset zoom\n              </Typography>\n              <Box sx={{ display: 'flex', gap: 2, alignItems: 'center', mb: 2 }}>\n                <TextField\n                  label=\"Start Frame\"\n                  type=\"number\"\n                  value={intervalStartFrame}\n                  onChange={(e) => {\n                    const v = e.target.value;\n                    console.log(\"Start Frame input:\", v);\n                    setIntervalStartFrame(v);\n                    if (v !== \"\") setMarkStart(Number(v));\n                    else setMarkStart(null);\n                  }}\n                  size=\"small\"\n                  inputProps={{ min: 0, step: 1 }}\n                  aria-label=\"Interval start frame\"\n                />\n                <TextField\n                  label=\"End Frame\"\n                  type=\"number\"\n                  value={intervalStartFrame !== \"\" ? intervalEndFrame : \"\"}\n                  onChange={(e) => {\n                    const v = e.target.value;\n                    console.log(\"End Frame input:\", v);\n                    setIntervalEndFrame(v);\n                  }}\n                  size=\"small\"\n                  inputProps={{ min: intervalStartFrame !== \"\" ? Number(intervalStartFrame) : 0, step: 1 }}\n                  aria-label=\"Interval end frame\"\n                  disabled={intervalStartFrame === \"\"}\n                />\n                <FormControl size=\"small\" sx={{ minWidth: 200 }}>\n                  <InputLabel>Behavior</InputLabel>\n                  <Select\n                    value={intervalBehavior}\n                    label=\"Behavior\"\n                    onChange={(e) => setIntervalBehavior(e.target.value)}\n                  >\n                    {behaviors.map((b, i) => (\n                      <MenuItem key={b} value={b}>{`${b} (${i + 1})`}</MenuItem>\n                    ))}\n                  </Select>\n                </FormControl>\n                <Button\n                  onClick={() => addInterval(intervalBehavior)}\n                  variant=\"contained\"\n                  aria-label=\"Add interval\"\n                  disabled={intervalStartFrame === \"\" || intervalEndFrame === \"\"}\n                >\n                  Add\n                </Button>\n              </Box>\n              <Table size=\"small\">\n                <TableHead>\n                  <TableRow>\n                    <TableCell>Interval (Frame)</TableCell>\n                    <TableCell>Behavior</TableCell>\n                    <TableCell>Delete</TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {intervals.length === 0 ? (\n                    <TableRow>\n                      <TableCell colSpan={3} align=\"center\">\n                        No intervals added yet.\n                      </TableCell>\n                    </TableRow>\n                  ) : (\n                    intervals\n                      .slice()\n                      .sort((a, b) => b.start - a.start)\n                      .slice(page * rowsPerPage, (page + 1) * rowsPerPage)\n                      .map((interval, i) => (\n                        <TableRow key={i}>\n                          <TableCell>{`${interval.start} - ${interval.end}`}</TableCell>\n                          <TableCell>\n                            <FormControl size=\"small\" sx={{ minWidth: 200 }}>\n                              <InputLabel>Behavior</InputLabel>\n                              <Select\n                                value={interval.behavior}\n                                label=\"Behavior\"\n                                onChange={(e) => updateIntervalBehavior(intervals.indexOf(interval), e.target.value)}\n                              >\n                                {behaviors.map((b, j) => (\n                                  <MenuItem key={b} value={b}>{`${b} (${j + 1})`}</MenuItem>\n                                ))}\n                              </Select>\n                            </FormControl>\n                          </TableCell>\n                          <TableCell>\n                            <Button\n                              variant=\"outlined\"\n                              color=\"error\"\n                              size=\"small\"\n                              onClick={() => removeInterval(intervals.indexOf(interval))}\n                              aria-label={`Delete interval ${i + 1}`}\n                            >\n                              Delete\n                            </Button>\n                          </TableCell>\n                        </TableRow>\n                      ))\n                  )}\n                </TableBody>\n              </Table>\n              {intervals.length > rowsPerPage && (\n                <Box sx={{ mt: 2, display: 'flex', gap: 2 }}>\n                  <Button\n                    onClick={() => setPage(p => Math.max(0, p - 1))}\n                    disabled={page === 0}\n                    variant=\"outlined\"\n                    aria-label=\"Previous page\"\n                  >\n                    Previous\n                  </Button>\n                  <Button\n                    onClick={() => setPage(p => p + 1)}\n                    disabled={(page + 1) * rowsPerPage >= intervals.length}\n                    variant=\"outlined\"\n                    aria-label=\"Next page\"\n                  >\n                    Next\n                  </Button>\n                  <Typography>\n                    Page {page + 1} / {Math.ceil(intervals.length / rowsPerPage)}\n                  </Typography>\n                </Box>\n              )}\n            </Box>\n          </Grid>\n        </Grid>\n      </Box>\n    </ThemeProvider>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}